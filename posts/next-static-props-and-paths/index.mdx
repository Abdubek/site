---
title: Next.js Static Props
date: 2020-03-22
responsive: false
---

import { Hike, View } from "../../src/components/mdx-hiker"
import views from "./views"

<Hike views={views}>

<View />

A few weeks ago, [Zeit released Next.js 9.3](https://nextjs.org/blog/next-9-3). This new version introduces two of the frameworks coolest APIs: `getStaticProps` and `getStaticPaths`.

With `getStaticProps` and `getStaticPaths` we have more control on what the app renders to HTML at build time. 

To show how to use this new feature, let's build an app.

The app downloads a JSON file with some Coronavirus stats from a public URL, it shows an `index` page with a chart using the data from the last day. The table has links to pages for each country showing a timeseries chart for that country.


The JSON has data for each country and for each day from the last months. The file is updated once per day.

If you want, try to think how would you build this site and then continue reading this post.

> Disclaimer: It isn't the purpose of this post to build accurate charts and data

<View />

To start, we initialize a new project using NextJS and React (and a few more dependencies that we're going to use later). 

If you are coding along run this on an empty folder.

Then add the scripts section to the `package.json`

<View />

Then create a `pages` folder and a `index.js` file in it. 

In Next.js, every js file in the `pages` folder will become a page. You need to add a React component as the default export.

For now, let's export a component that renders `<h1>Hello</h1>`.

<View />

Now that we have a minimal project using NextJS, run it to check that everything is working.

We need to install the dependencies, we can do that we `yarn` or `npm`: `yarn install`.

After all the dependencies are installed, we run the development version of our site with `yarn dev`.


<View />

Our app is live at https://localhost:3000.

Let's add more things to this minimal website one by one. We start by downloading the json when the site loads.

<View />

We wrap the fetch code inside a `useData` hook that returns `undefined` until the JSON is downloaded.

In our `HomePage` component we call the `useData` hook and show "Loading..." until we have the data.

Now let's use the data for something. 

<View />

One quick thing we can do with the data is extract the last date from the time-series and show it. 

Stop for a moment here. What have we done?

Everytime a user visit our site we show they a "Loading..." text until the site downloads a big JSON, which it then transform to less than 10 bytes of information. Not to mention all the javascript downloaded to use React and NextJS.

Our site may be an extreme example, but this problem is relevant to many types of websites were most of the content don't change frequently.    

<View />

`getStaticProps` to the rescue.

Instead of fetching the data from the browser every time a user visits our site, we are going to fetch it during build-time (this is when you or a build server run `yarn build`).

With NextJS, we can define `getStaticProps`...

In our example, we fetch the JSON in `getStaticProps` and return it as the `data` prop. Then the `HomePage` component receive that `data` prop. We don't need the `useData` hook, nor we need to show the "Loading..." text anymore.

Note that we are using `node-fetch` instead of the browser's `fetch`. That's because `getStaticProps` doesn't run on the browser, it runs on Node. This means you could, for example, access the file system inside `getStaticProps`.

<View />

We are not showing the "Loading..." text anymore and the date is already in the HTML when a user visits our site. That's an improvement, but NextJS is still sending all the `data` to the browser.

Instead of passing the whole data object to the `HomePage` component, we can extract only the things we need during build-time on `getStaticProps`.

Now, when a user visit our site, it will be as fast as the minimal Hello World site we had at the beginning.

<View />

Let's do something more interesting and plot part of the data from the JSON.

We will need the last stats from each country, so we extract that on `getStaticProps` and pass it to the `HomePage` as props.

`rows` is an array like the following:

```json
[
  {
    country: 'France',
    deaths: 10,
  },
  {
    country: 'France',
    deaths: 10,
  },
  ...
]
```

<View />

We will plot the rows in the `Chart` component. So we add the `Chart` element to the `HomePage` and pass the `rows` props.

We will plot the rows in the `Chart` component. So we add the `Chart` element to the `HomePage` and pass the `rows` props.

<View />

// do something more interesting, render the table

> https://x1-5p8jjgqz9.now.sh/

So far we haven't done anything impressive. A script that download the JSON and builds the html could do the same without the need of any framework.

Let's show a chart with some stats.

> https://x1-bx780mpxy.now.sh/

```jsx
```

Cool thing is, the chart is rendered even if we disable javascript.


<View />

So far we haven't done anything impressive. A script that download the JSON and builds the html could do the same without the need of any framework.

Let's show a chart with some stats.

> https://x1-bx780mpxy.now.sh/

```jsx
```

Cool thing is, the chart is rendered even if we disable javascript.


<View />

So far we haven't done anything impressive. A script that download the JSON and builds the html could do the same without the need of any framework.

Let's show a chart with some stats.

> https://x1-bx780mpxy.now.sh/

```jsx
```

Cool thing is, the chart is rendered even if we disable javascript.

<View />

Let's make the add links

So far we haven't done anything impressive. A script that download the JSON and builds the html could do the same without the need of any framework.

Let's show a chart with some stats.

<View />

Let's make the add links

So far we haven't done anything impressive. A script that download the JSON and builds the html could do the same without the need of any framework.

Let's show a chart with some stats.


---

https://nextjs.org/blog/next-9-3
https://nextjs.org/blog/next-9
https://nextjs.org/docs/basic-features/data-fetching
https://nextjs.org/docs/routing/dynamic-routes

</Hike>
